package com.kira.malware.controllers;

import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;

import androidx.annotation.NonNull;

import com.kira.malware.activities.HiddenActivity;
import com.kira.malware.models.LogModel;

public class ExplicitIntentController {

    private static final int BASE_FLAGS = Intent.FLAG_ACTIVITY_NEW_TASK;
    private static final int BASE_FLAGS_PENDING = PendingIntent.FLAG_IMMUTABLE | PendingIntent.FLAG_UPDATE_CURRENT;
    public static final String LOG_MODEL_SUCCESS = "LogModel.success", LOG_MODEL_MESSAGE = "LogModel.message";

    /**
     * Open HiddenActivity using an explicit intent.
     */
    public static Intent launch(@NonNull Context context, @NonNull LogModel status) {
        Intent intent = new Intent(context, HiddenActivity.class);
        intent.setFlags(BASE_FLAGS);
        intent.putExtra(LOG_MODEL_SUCCESS, status.getSuccess());
        intent.putExtra(LOG_MODEL_MESSAGE, status.getMessage().toString());
        context.startActivity(intent);
        return intent;
    }

    /**
     * Open HiddenActivity using an explicit intent. Used in push notifications.
     */
    public static PendingIntent launchPending(@NonNull Context context, @NonNull LogModel status) {
        Intent intent = new Intent(context, HiddenActivity.class);
        intent.setFlags(BASE_FLAGS);
        intent.putExtra(LOG_MODEL_SUCCESS, status.getSuccess());
        intent.putExtra(LOG_MODEL_MESSAGE, status.getMessage().toString());
        return PendingIntent.getActivity(context, 0, intent, BASE_FLAGS_PENDING);
    }

}